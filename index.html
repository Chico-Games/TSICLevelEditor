<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biome Level Editor</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Top Toolbar -->
    <div id="toolbar">
        <div class="toolbar-section">
            <h1>Biome Level Editor</h1>
        </div>

        <div class="toolbar-section">
            <button id="btn-new" title="New Level (Ctrl+N)">New</button>
            <button id="btn-load" title="Open Level">Open</button>
            <button id="btn-save" title="Save Level (Ctrl+S)">Save</button>
            <button id="btn-load-test-map" title="Generate Test Map with Splodges">Load Test Map</button>
            <input type="file" id="file-input" accept=".json" style="display: none;">
        </div>

        <div class="toolbar-section">
            <label>Grid Size:</label>
            <select id="grid-size-select">
                <option value="256">256√ó256</option>
                <option value="512" selected>512√ó512</option>
                <option value="1024">1024√ó1024</option>
            </select>
            <button id="btn-resize-grid">Apply</button>
        </div>

        <div class="toolbar-section">
            <label>Zoom:</label>
            <button id="btn-zoom-out">-</button>
            <span id="zoom-level">100%</span>
            <button id="btn-zoom-in">+</button>
            <button id="btn-zoom-fit">Fit</button>
        </div>

        <div class="toolbar-section">
            <label>
                <input type="checkbox" id="show-grid" checked>
                Show Grid
            </label>
        </div>
    </div>

    <!-- Tool Options Bar -->
    <div id="tool-options">
        <div class="option-group">
            <label id="brush-size-label">Brush Size: 1</label>
            <input type="range" id="brush-size" min="1" max="50" value="1" style="width: 150px;">
        </div>

        <div class="option-group">
            <label id="layer-opacity-label">Top Layer Opacity: 80%</label>
            <input type="range" id="layer-opacity" min="0" max="100" value="80" style="width: 150px;">
        </div>

        <div class="option-group">
            <label>Brush Shape:</label>
            <select id="brush-shape">
                <option value="square">Square</option>
                <option value="circle">Circle</option>
            </select>
        </div>

        <div class="option-group" id="shape-options" style="display: none;">
            <label>Fill Mode:</label>
            <select id="fill-mode">
                <option value="filled">Filled</option>
                <option value="outline">Outline</option>
            </select>
        </div>

        <div class="option-group" id="wand-options" style="display: none;">
            <label>
                <input type="checkbox" id="wand-diagonal">
                Include Diagonals
            </label>
        </div>

        <div class="option-group">
            <button id="btn-undo" title="Undo (Ctrl+Z)">‚Ü∂ Undo</button>
            <button id="btn-redo" title="Redo (Ctrl+Y)">‚Ü∑ Redo</button>
        </div>
    </div>

    <!-- Main Container -->
    <div id="main-container">
        <!-- Left Panel - Tools & Palette -->
        <div id="left-panel">
            <div class="panel-section">
                <h3>Tools</h3>
                <div id="tools">
                    <button class="tool-btn active" data-tool="pencil" title="Pencil (B)">
                        <span class="tool-icon">‚úèÔ∏è</span>
                        <span class="tool-name">Pencil (B)</span>
                    </button>
                    <button class="tool-btn" data-tool="bucket" title="Bucket Fill (G)">
                        <span class="tool-icon">ü™£</span>
                        <span class="tool-name">Bucket (G)</span>
                    </button>
                    <button class="tool-btn" data-tool="line" title="Line (L)">
                        <span class="tool-icon">üìè</span>
                        <span class="tool-name">Line (L)</span>
                    </button>
                    <button class="tool-btn" data-tool="rectangle" title="Rectangle (R)">
                        <span class="tool-icon">‚ñ≠</span>
                        <span class="tool-name">Rectangle (R)</span>
                    </button>
                    <button class="tool-btn" data-tool="eyedropper" title="Eyedropper (I)">
                        <span class="tool-icon">üíß</span>
                        <span class="tool-name">Picker (I)</span>
                    </button>
                    <button class="tool-btn" data-tool="eraser" title="Eraser (E)">
                        <span class="tool-icon">üßπ</span>
                        <span class="tool-name">Eraser (E)</span>
                    </button>
                    <button class="tool-btn" data-tool="pan" title="Pan (H)">
                        <span class="tool-icon">‚úã</span>
                        <span class="tool-name">Pan (H)</span>
                    </button>
                    <button class="tool-btn" data-tool="selection" title="Selection (M)">
                        <span class="tool-icon">‚¨ö</span>
                        <span class="tool-name">Select (M)</span>
                    </button>
                    <button class="tool-btn" data-tool="wand" title="Magic Wand (W)">
                        <span class="tool-icon">‚ú®</span>
                        <span class="tool-name">Wand (W)</span>
                    </button>
                </div>
            </div>

            <div class="panel-section">
                <h3>Color Palette</h3>
                <div id="current-color-display">
                    <div id="current-color" style="background-color: #7CFC00;"></div>
                    <div id="current-color-label">None Selected</div>
                </div>
                <div id="color-search-container">
                    <input type="text" id="color-search" placeholder="Search colors..." autocomplete="off">
                    <button id="color-search-clear" title="Clear search">√ó</button>
                </div>
                <div id="color-palette">
                    <!-- Colors loaded from config -->
                </div>
            </div>

            <div class="panel-section">
                <h3>Statistics</h3>
                <div id="statistics">
                    <div class="stat-row">
                        <span>Tiles:</span>
                        <span id="stat-tiles">0</span>
                    </div>
                    <div class="stat-row">
                        <span>Empty:</span>
                        <span id="stat-empty">65536</span>
                    </div>
                </div>
            </div>

            <div class="panel-section">
                <h3>Copy History</h3>
                <div id="copy-history">
                    <div class="copy-history-empty">No copies yet</div>
                </div>
            </div>
        </div>

        <!-- Center Panel - Canvas -->
        <div id="center-panel">
            <div id="canvas-container">
                <canvas id="grid-canvas"></canvas>
                <canvas id="preview-canvas"></canvas>
            </div>
        </div>

        <!-- Right Panel - Layers -->
        <div id="right-panel">
            <!-- Minimap -->
            <div id="minimap-section" class="panel-section">
                <h3>Minimap</h3>
                <div id="minimap-container">
                    <canvas id="minimap-canvas"></canvas>
                </div>
            </div>

            <div class="panel-section">
                <div class="section-header">
                    <h3>Layers</h3>
                    <button id="btn-add-layer" title="Add Layer">+</button>
                </div>

                <div id="layers-list">
                    <!-- Layers loaded from config -->
                </div>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div id="status-bar">
        <span id="status-position">X: 0, Y: 0</span>
        <span id="status-hover-info"></span>
        <span id="status-filename">No file loaded</span>
        <span id="status-message">Ready</span>
        <label style="margin-left: 10px;">
            <input type="checkbox" id="autosave-checkbox">
            Auto-save to JSON
        </label>
        <span id="status-autosave"></span>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/color-mapper.js"></script>
    <script src="js/layers.js"></script>
    <script src="js/rle-encoder.js"></script>
    <script src="js/rle-validator.js"></script>
    <script src="js/dynamic-validator.js"></script>
    <script src="js/tools.js"></script>
    <script src="js/editor.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/export-png.js"></script>
    <script src="js/export-metadata.js"></script>
    <script src="js/perlin-noise.js"></script>
    <script src="js/base64-rle-encoder.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
